#include <cstdlib>
#include "gauss_legendre_points.hh"

namespace OrbitUtils{
	
	/*  n = 1 */ 
	static double z2[1] = {5.773502691896257e-01}; 
	static double w2[1] = {1.000000000000000e+00}; 
	
	/*  n = 2 */ 
	static double z4[2] = {3.399810435848563e-01,8.611363115940526e-01}; 
	static double w4[2] = {6.521451548625461e-01,3.478548451374538e-01}; 
	
	/*  n = 3 */ 
	static double z8[4] = {1.834346424956498e-01,5.255324099163290e-01,7.966664774136267e-01,9.602898564975363e-01}; 
	static double w8[4] = {3.626837833783620e-01,3.137066458778873e-01,2.223810344533745e-01,1.012285362903763e-01}; 
	
	/*  n = 4 */ 
	static double z16[8] = {9.501250983763744e-02,2.816035507792589e-01,4.580167776572274e-01,6.178762444026438e-01,7.554044083550030e-01,8.656312023878318e-01,9.445750230732326e-01,9.894009349916499e-01}; 
	static double w16[8] = {1.894506104550685e-01,1.826034150449236e-01,1.691565193950025e-01,1.495959888165767e-01,1.246289712555339e-01,9.515851168249279e-02,6.225352393864789e-02,2.715245941175410e-02}; 
	
	/*  n = 5 */ 
	static double z32[16] = {4.830766568773832e-02,1.444719615827965e-01,2.392873622521371e-01,3.318686022821277e-01,4.213512761306353e-01,5.068999089322294e-01,5.877157572407623e-01,6.630442669302152e-01,7.321821187402897e-01,7.944837959679424e-01,8.493676137325700e-01,8.963211557660521e-01,9.349060759377397e-01,9.647622555875064e-01,9.856115115452684e-01,9.972638618494816e-01}; 
	static double w32[16] = {9.654008851472780e-02,9.563872007927486e-02,9.384439908080457e-02,9.117387869576389e-02,8.765209300440381e-02,8.331192422694675e-02,7.819389578707031e-02,7.234579410884850e-02,6.582222277636185e-02,5.868409347853554e-02,5.099805926237617e-02,4.283589802222668e-02,3.427386291302143e-02,2.539206530926206e-02,1.627439473090567e-02,7.018610009470096e-03}; 
	
	/*  n = 6 */ 
	static double z64[32] = {2.435029266342443e-02,7.299312178779904e-02,1.214628192961206e-01,1.696444204239928e-01,2.174236437400071e-01,2.646871622087674e-01,3.113228719902110e-01,3.572201583376681e-01,4.022701579639916e-01,4.463660172534641e-01,4.894031457070530e-01,5.312794640198946e-01,5.718956462026340e-01,6.111553551723933e-01,6.489654712546573e-01,6.852363130542333e-01,7.198818501716109e-01,7.528199072605319e-01,7.839723589433414e-01,8.132653151227975e-01,8.406292962525803e-01,8.659993981540928e-01,8.893154459951141e-01,9.105221370785028e-01,9.295691721319396e-01,9.464113748584028e-01,9.610087996520538e-01,9.733268277899110e-01,9.833362538846260e-01,9.910133714767443e-01,9.963401167719553e-01,9.993050417357722e-01}; 
	static double w64[32] = {4.869095700913972e-02,4.857546744150343e-02,4.834476223480295e-02,4.799938859645831e-02,4.754016571483031e-02,4.696818281621002e-02,4.628479658131442e-02,4.549162792741814e-02,4.459055816375657e-02,4.358372452932345e-02,4.247351512365359e-02,4.126256324262353e-02,3.995374113272034e-02,3.855015317861563e-02,3.705512854024005e-02,3.547221325688239e-02,3.380516183714161e-02,3.205792835485155e-02,3.023465707240248e-02,2.833967261425948e-02,2.637746971505466e-02,2.435270256871087e-02,2.227017380838325e-02,2.013482315353021e-02,1.795171577569734e-02,1.572603047602472e-02,1.346304789671864e-02,1.116813946013113e-02,8.846759826363947e-03,6.504457968978363e-03,4.147033260562468e-03,1.783280721696433e-03}; 
	
	/*  n = 7 */ 
	static double z128[64] = {1.222369896061576e-02,3.666379096873349e-02,6.108196960413957e-02,8.546364050451549e-02,1.097942311276437e-01,1.340591994611878e-01,1.582440427142249e-01,1.823343059853372e-01,2.063155909020792e-01,2.301735642266600e-01,2.538939664226943e-01,2.774626201779044e-01,3.008654388776772e-01,3.240884350244134e-01,3.471177285976355e-01,3.699395553498590e-01,3.925402750332674e-01,4.149063795522750e-01,4.370245010371042e-01,4.588814198335522e-01,4.804640724041720e-01,5.017595591361445e-01,5.227551520511755e-01,5.434383024128103e-01,5.637966482266181e-01,5.838180216287631e-01,6.034904561585486e-01,6.228021939105849e-01,6.417416925623075e-01,6.602976322726460e-01,6.784589224477192e-01,6.962147083695144e-01,7.135543776835874e-01,7.304675667419088e-01,7.469441667970620e-01,7.629743300440948e-01,7.785484755064119e-01,7.936572947621933e-01,8.082917575079137e-01,8.224431169556439e-01,8.361029150609068e-01,8.492629875779689e-01,8.619154689395485e-01,8.740527969580318e-01,8.856677173453972e-01,8.967532880491582e-01,9.073028834017568e-01,9.173101980809605e-01,9.267692508789478e-01,9.356743882779164e-01,9.440202878302202e-01,9.518019613412644e-01,9.590147578536999e-01,9.656543664319652e-01,9.717168187471366e-01,9.771984914639074e-01,9.820961084357185e-01,9.864067427245862e-01,9.901278184917344e-01,9.932571129002129e-01,9.957927585349812e-01,9.977332486255140e-01,9.990774599773758e-01,9.998248879471319e-01}; 
	static double w128[64] = {2.444618019626252e-02,2.443156909785004e-02,2.440235563384958e-02,2.435855726469063e-02,2.430020016797187e-02,2.422731922281525e-02,2.413995798901929e-02,2.403816868102405e-02,2.392201213670346e-02,2.379155778100340e-02,2.364688358444762e-02,2.348807601653591e-02,2.331522999406276e-02,2.312844882438703e-02,2.292784414368685e-02,2.271353585023646e-02,2.248565203274497e-02,2.224432889379976e-02,2.198971066846049e-02,2.172194953805208e-02,2.144120553920846e-02,2.114764646822135e-02,2.084144778075115e-02,2.052279248696007e-02,2.019187104213004e-02,1.984888123283086e-02,1.949402805870660e-02,1.912752360995094e-02,1.874958694054471e-02,1.836044393733134e-02,1.796032718500869e-02,1.754947582711771e-02,1.712813542311138e-02,1.669655780158921e-02,1.625500090978519e-02,1.580372865939935e-02,1.534301076886514e-02,1.487312260214731e-02,1.439434500416685e-02,1.390696413295199e-02,1.341127128861633e-02,1.290756273926735e-02,1.239613954395092e-02,1.187730737274028e-02,1.135137632408042e-02,1.081866073950308e-02,1.027947901583216e-02,9.734153415006806e-03,9.183009871660874e-03,8.626377798616750e-03,8.064589890486059e-03,7.497981925634729e-03,6.926892566898814e-03,6.351663161707189e-03,5.772637542865698e-03,5.190161832676330e-03,4.604584256702955e-03,4.016254983738642e-03,3.425526040910216e-03,2.832751471457991e-03,2.238288430962619e-03,1.642503018669029e-03,1.045812679340349e-03,4.493809602920904e-04}; 
	
	/*  n = 8 */ 
	static double z256[128] = {6.123912375189529e-03,1.837081847881367e-02,3.061496877997903e-02,4.285452653637910e-02,5.508765569463398e-02,6.731252116571640e-02,7.952728910023296e-02,9.173012716351955e-02,1.039192048105094e-01,1.160926935603328e-01,1.282487672706071e-01,1.403856024113759e-01,1.525013783386564e-01,1.645942775675538e-01,1.766624860449020e-01,1.887041934213888e-01,2.007175933231267e-01,2.127008836226260e-01,2.246522667091320e-01,2.365699497582840e-01,2.484521450010567e-01,2.602970699919425e-01,2.721029478763366e-01,2.838680076570818e-01,2.955904844601356e-01,3.072686197993191e-01,3.189006618401063e-01,3.304848656624170e-01,3.420194935223717e-01,3.535028151129700e-01,3.649331078236540e-01,3.763086569987164e-01,3.876277561945156e-01,3.988887074354591e-01,4.100898214687165e-01,4.212294180176238e-01,4.323058260337413e-01,4.433173839475273e-01,4.542624399175900e-01,4.651393520784793e-01,4.759464887869833e-01,4.866822288668903e-01,4.973449618521815e-01,5.079330882286160e-01,5.184450196736745e-01,5.288791792948223e-01,5.392340018660592e-01,5.495079340627186e-01,5.596994346944811e-01,5.698069749365687e-01,5.798290385590830e-01,5.897641221544543e-01,5.996107353629683e-01,6.093674010963339e-01,6.190326557592613e-01,6.286050494690150e-01,6.380831462729114e-01,6.474655243637248e-01,6.567507762929732e-01,6.659375091820485e-01,6.750243449311628e-01,6.840099204260760e-01,6.928928877425770e-01,7.016719143486851e-01,7.103456833045433e-01,7.189128934599714e-01,7.273722596496521e-01,7.357225128859178e-01,7.439624005491116e-01,7.520906865754921e-01,7.601061516426555e-01,7.680075933524456e-01,7.757938264113258e-01,7.834636828081838e-01,7.910160119895460e-01,7.984496810321707e-01,8.057635748129987e-01,8.129565961764316e-01,8.200276660989171e-01,8.269757238508125e-01,8.337997271555049e-01,8.404986523457627e-01,8.470714945172962e-01,8.535172676795030e-01,8.598350049033764e-01,8.660237584665545e-01,8.720825999954883e-01,8.780106206047066e-01,8.838069310331583e-01,8.894706617776109e-01,8.950009632230845e-01,9.003970057703036e-01,9.056579799601446e-01,9.107830965950651e-01,9.157715868574904e-01,9.206227024251465e-01,9.253357155833162e-01,9.299099193340057e-01,9.343446275020031e-01,9.386391748378148e-01,9.427929171174625e-01,9.468052312391275e-01,9.506755153166283e-01,9.544031887697162e-01,9.579876924111781e-01,9.614284885307322e-01,9.647250609757064e-01,9.678769152284895e-01,9.708835784807430e-01,9.737445997043704e-01,9.764595497192342e-01,9.790280212576220e-01,9.814496290254644e-01,9.837240097603155e-01,9.858508222861260e-01,9.878297475648606e-01,9.896604887450652e-01,9.913427712075831e-01,9.928763426088221e-01,9.942609729224097e-01,9.954964544810964e-01,9.965826020233816e-01,9.975192527567208e-01,9.983062664730065e-01,9.989435258434088e-01,9.994309374662614e-01,9.997684374092631e-01,9.999560500189922e-01}; 
	static double w256[128] = {1.224767164028976e-02,1.224583436974792e-02,1.224216010427280e-02,1.223664939504016e-02,1.222930306871028e-02,1.222012222730397e-02,1.220910824803724e-02,1.219626278311471e-02,1.218158775948177e-02,1.216508537853550e-02,1.214675811579446e-02,1.212660872052732e-02,1.210464021534046e-02,1.208085589572454e-02,1.205525932956015e-02,1.202785435658257e-02,1.199864508780581e-02,1.196763590490589e-02,1.193483145956356e-02,1.190023667276649e-02,1.186385673407108e-02,1.182569710082398e-02,1.178576349734343e-02,1.174406191406055e-02,1.170059860662074e-02,1.165538009494524e-02,1.160841316225311e-02,1.155970485404363e-02,1.150926247703950e-02,1.145709359809064e-02,1.140320604303919e-02,1.134760789554549e-02,1.129030749587551e-02,1.123131343964967e-02,1.117063457655345e-02,1.110828000900984e-02,1.104425909081390e-02,1.097858142572957e-02,1.091125686604904e-02,1.084229551111480e-02,1.077170770580463e-02,1.069950403897978e-02,1.062569534189656e-02,1.055029268658148e-02,1.047330738417040e-02,1.039475098321173e-02,1.031463526793401e-02,1.023297225647822e-02,1.014977419909487e-02,1.006505357630638e-02,9.978823097034911e-03,9.891095696695829e-03,9.801884535257328e-03,9.711202995266279e-03,9.619064679840727e-03,9.525483410629285e-03,9.430473225737753e-03,9.334048377623270e-03,9.236223330956302e-03,9.137012760450806e-03,9.036431548662873e-03,8.934494783758207e-03,8.831217757248750e-03,8.726615961698807e-03,8.620705088401015e-03,8.513501025022491e-03,8.405019853221537e-03,8.295277846235226e-03,8.184291466438270e-03,8.072077362873499e-03,7.958652368754348e-03,7.844033498939713e-03,7.728237947381556e-03,7.611283084545659e-03,7.493186454805884e-03,7.373965773812346e-03,7.253638925833914e-03,7.132223961075390e-03,7.009739092969823e-03,6.886202695446320e-03,6.761633300173799e-03,6.636049593781065e-03,6.509470415053661e-03,6.381914752107881e-03,6.253401739542401e-03,6.123950655567933e-03,5.993580919115339e-03,5.862312086922653e-03,5.730163850601437e-03,5.597156033682910e-03,5.463308588644310e-03,5.328641593915931e-03,5.193175250869281e-03,5.056929880786843e-03,4.919925921813866e-03,4.782183925892691e-03,4.643724555680060e-03,4.504568581447897e-03,4.364736877968057e-03,4.224250421381536e-03,4.083130286052668e-03,3.941397641408833e-03,3.799073748766258e-03,3.656179958142502e-03,3.512737705056307e-03,3.368768507315551e-03,3.224293961794198e-03,3.079335741199337e-03,2.933915590829717e-03,2.788055325327707e-03,2.641776825427490e-03,2.495102034703707e-03,2.348052956327312e-03,2.200651649839911e-03,2.052920227966143e-03,1.904880853499718e-03,1.756555736330730e-03,1.607967130749327e-03,1.459137333310733e-03,1.310088681902505e-03,1.160843557567725e-03,1.011424393208441e-03,8.618537014200890e-04,7.121541634733207e-04,5.623489540314098e-04,4.124632544261763e-04,2.625349442964459e-04,1.127890178222722e-04}; 
	
	/*  n = 9 */ 
	static double z512[256] = {3.064962185159396e-03,9.194771386432911e-03,1.532423508489819e-02,2.145312295977488e-02,2.758120471191979e-02,3.370825007248059e-02,3.983402881154845e-02,4.595831074680906e-02,5.208086575219207e-02,5.820146376651824e-02,6.431987480214424e-02,7.043586895360469e-02,7.654921640625105e-02,8.265968744488716e-02,8.876705246240103e-02,9.487108196839254e-02,1.009715465977968e-01,1.070682171195027e-01,1.131608644449665e-01,1.192492596368204e-01,1.253331739174745e-01,1.314123786777137e-01,1.374866454852881e-01,1.435557460934960e-01,1.496194524497613e-01,1.556775367042019e-01,1.617297712181921e-01,1.677759285729161e-01,1.738157815779134e-01,1.798491032796159e-01,1.858756669698757e-01,1.918952461944840e-01,1.979076147616805e-01,2.039125467506524e-01,2.099098165200239e-01,2.158991987163350e-01,2.218804682825090e-01,2.278534004663096e-01,2.338177708287859e-01,2.397733552527062e-01,2.457199299509792e-01,2.516572714750633e-01,2.575851567233626e-01,2.635033629496103e-01,2.694116677712386e-01,2.753098491777350e-01,2.811976855389847e-01,2.870749556135980e-01,2.929414385572244e-01,2.987969139308507e-01,3.046411617090842e-01,3.104739622884204e-01,3.162950964954949e-01,3.221043455953188e-01,3.279014912994984e-01,3.336863157744371e-01,3.394586016495210e-01,3.452181320252867e-01,3.509646904815714e-01,3.566980610856456e-01,3.624180284003264e-01,3.681243774920731e-01,3.738168939390634e-01,3.794953638392505e-01,3.851595738184011e-01,3.908093110381125e-01,3.964443632038105e-01,4.020645185727270e-01,4.076695659618556e-01,4.132592947558876e-01,4.188334949151263e-01,4.243919569833787e-01,4.299344720958266e-01,4.354608319868747e-01,4.409708289979767e-01,4.464642560854375e-01,4.519409068281941e-01,4.574005754355713e-01,4.628430567550148e-01,4.682681462798001e-01,4.736756401567166e-01,4.790653351937285e-01,4.844370288676086e-01,4.897905193315499e-01,4.951256054227486e-01,5.004420866699644e-01,5.057397633010522e-01,5.110184362504699e-01,5.162779071667575e-01,5.215179784199908e-01,5.267384531092077e-01,5.319391350698066e-01,5.371198288809178e-01,5.422803398727462e-01,5.474204741338866e-01,5.525400385186102e-01,5.576388406541219e-01,5.627166889477890e-01,5.677733925943407e-01,5.728087615830374e-01,5.778226067048111e-01,5.828147395593745e-01,5.877849725623008e-01,5.927331189520721e-01,5.976589927970977e-01,6.025624090026994e-01,6.074431833180683e-01,6.123011323431869e-01,6.171360735357212e-01,6.219478252178794e-01,6.267362065832393e-01,6.315010377035416e-01,6.362421395354517e-01,6.409593339272864e-01,6.456524436257089e-01,6.503212922823893e-01,6.549657044606303e-01,6.595855056419603e-01,6.641805222326905e-01,6.687505815704384e-01,6.732955119306152e-01,6.778151425328788e-01,6.823093035475509e-01,6.867778261019991e-01,6.912205422869816e-01,6.956372851629570e-01,7.000278887663572e-01,7.043921881158238e-01,7.087300192184071e-01,7.130412190757285e-01,7.173256256901053e-01,7.215830780706379e-01,7.258134162392593e-01,7.300164812367466e-01,7.341921151286930e-01,7.383401610114442e-01,7.424604630179923e-01,7.465528663238341e-01,7.506172171527881e-01,7.546533627827725e-01,7.586611515515449e-01,7.626404328624002e-01,7.665910571898299e-01,7.705128760851405e-01,7.744057421820317e-01,7.782695092021338e-01,7.821040319605042e-01,7.859091663710830e-01,7.896847694521072e-01,7.934306993314830e-01,7.971468152521175e-01,8.008329775772071e-01,8.044890477954846e-01,8.081148885264243e-01,8.117103635254043e-01,8.152753376888249e-01,8.188096770591868e-01,8.223132488301236e-01,8.257859213513925e-01,8.292275641338213e-01,8.326380478542114e-01,8.360172443601974e-01,8.393650266750627e-01,8.426812690025105e-01,8.459658467313906e-01,8.492186364403826e-01,8.524395159026327e-01,8.556283640903465e-01,8.587850611793374e-01,8.619094885535290e-01,8.650015288094115e-01,8.680610657604539e-01,8.710879844414698e-01,8.740821711129373e-01,8.770435132652723e-01,8.799718996230571e-01,8.828672201492210e-01,8.857293660491754e-01,8.885582297749018e-01,8.913537050289927e-01,8.941156867686465e-01,8.968440712096138e-01,8.995387558300979e-01,9.021996393746068e-01,9.048266218577580e-01,9.074196045680355e-01,9.099784900714992e-01,9.125031822154460e-01,9.149935861320229e-01,9.174496082417911e-01,9.198711562572436e-01,9.222581391862719e-01,9.246104673355856e-01,9.269280523140828e-01,9.292108070361711e-01,9.314586457250403e-01,9.336714839158854e-01,9.358492384590805e-01,9.379918275233031e-01,9.400991705986094e-01,9.421711884994589e-01,9.442078033676905e-01,9.462089386754480e-01,9.481745192280551e-01,9.501044711668419e-01,9.519987219719198e-01,9.538572004649060e-01,9.556798368115988e-01,9.574665625246019e-01,9.592173104658972e-01,9.609320148493677e-01,9.626106112432703e-01,9.642530365726560e-01,9.658592291217407e-01,9.674291285362238e-01,9.689626758255566e-01,9.704598133651587e-01,9.719204848985836e-01,9.733446355396325e-01,9.747322117744170e-01,9.760831614633703e-01,9.773974338432059e-01,9.786749795288263e-01,9.799157505151782e-01,9.811197001790571e-01,9.822867832808596e-01,9.834169559662840e-01,9.845101757679784e-01,9.855664016071379e-01,9.865855937950492e-01,9.875677140345829e-01,9.885127254216350e-01,9.894205924465157e-01,9.902912809952868e-01,9.911247583510481e-01,9.919209931951715e-01,9.926799556084865e-01,9.934016170724148e-01,9.940859504700559e-01,9.947329300872282e-01,9.953425316134658e-01,9.959147321429772e-01,9.964495101755774e-01,9.969468456176038e-01,9.974067197828498e-01,9.978291153935629e-01,9.982140165816128e-01,9.985614088900397e-01,9.988712792754494e-01,9.991436161123782e-01,9.993784092025992e-01,9.995756497983108e-01,9.997353306710427e-01,9.998574463699794e-01,9.999419946068456e-01,9.999889909843819e-01}; 
	static double w512[256] = {6.129905175405786e-03,6.129674838036499e-03,6.129214171953084e-03,6.128523194465533e-03,6.127601931538023e-03,6.126450417787936e-03,6.125068696484565e-03,6.123456819547480e-03,6.121614847544583e-03,6.119542849689829e-03,6.117240903840629e-03,6.114709096494917e-03,6.111947522787910e-03,6.108956286488523e-03,6.105735499995479e-03,6.102285284333078e-03,6.098605769146653e-03,6.094697092697698e-03,6.090559401858673e-03,6.086192852107484e-03,6.081597607521643e-03,6.076773840772098e-03,6.071721733116751e-03,6.066441474393642e-03,6.060933263013817e-03,6.055197305953877e-03,6.049233818748190e-03,6.043043025480804e-03,6.036625158777020e-03,6.029980459794651e-03,6.023109178214963e-03,6.016011572233293e-03,6.008687908549342e-03,6.001138462357161e-03,5.993363517334803e-03,5.985363365633671e-03,5.977138307867531e-03,5.968688653101226e-03,5.960014718839055e-03,5.951116831012846e-03,5.941995323969708e-03,5.932650540459467e-03,5.923082831621790e-03,5.913292556972986e-03,5.903280084392497e-03,5.893045790109079e-03,5.882590058686662e-03,5.871913283009901e-03,5.861015864269407e-03,5.849898211946682e-03,5.838560743798723e-03,5.827003885842332e-03,5.815228072338101e-03,5.803233745774101e-03,5.791021356849247e-03,5.778591364456372e-03,5.765944235664974e-03,5.753080445703675e-03,5.740000477942355e-03,5.726704823873997e-03,5.713193983096209e-03,5.699468463292460e-03,5.685528780213001e-03,5.671375457655483e-03,5.657009027445275e-03,5.642430029415480e-03,5.627639011386654e-03,5.612636529146217e-03,5.597423146427570e-03,5.581999434888912e-03,5.566365974091761e-03,5.550523351479171e-03,5.534472162353666e-03,5.518213009854868e-03,5.501746504936828e-03,5.485073266345076e-03,5.468193920593369e-03,5.451109101940146e-03,5.433819452364700e-03,5.416325621543051e-03,5.398628266823536e-03,5.380728053202108e-03,5.362625653297345e-03,5.344321747325183e-03,5.325817023073349e-03,5.307112175875518e-03,5.288207908585191e-03,5.269104931549276e-03,5.249803962581403e-03,5.230305726934945e-03,5.210610957275773e-03,5.190720393654719e-03,5.170634783479774e-03,5.150354881487996e-03,5.129881449717156e-03,5.109215257477103e-03,5.088357081320852e-03,5.067307705015410e-03,5.046067919512320e-03,5.024638522917945e-03,5.003020320463474e-03,4.981214124474668e-03,4.959220754341334e-03,4.937041036486537e-03,4.914675804335544e-03,4.892125898284511e-03,4.869392165668900e-03,4.846475460731643e-03,4.823376644591041e-03,4.800096585208407e-03,4.776636157355451e-03,4.752996242581413e-03,4.729177729179931e-03,4.705181512155670e-03,4.681008493190686e-03,4.656659580610546e-03,4.632135689350198e-03,4.607437740919592e-03,4.582566663369048e-03,4.557523391254390e-03,4.532308865601825e-03,4.506924033872585e-03,4.481369849927326e-03,4.455647273990282e-03,4.429757272613187e-03,4.403700818638955e-03,4.377478891165124e-03,4.351092475507066e-03,4.324542563160961e-03,4.297830151766545e-03,4.270956245069616e-03,4.243921852884324e-03,4.216727991055221e-03,4.189375681419093e-03,4.161865951766562e-03,4.134199835803464e-03,4.106378373112013e-03,4.078402609111728e-03,4.050273595020158e-03,4.021992387813378e-03,3.993560050186275e-03,3.964977650512609e-03,3.936246262804879e-03,3.907366966673955e-03,3.878340847288517e-03,3.849168995334278e-03,3.819852506972998e-03,3.790392483801296e-03,3.760790032809257e-03,3.731046266338834e-03,3.701162302042053e-03,3.671139262839014e-03,3.640978276875699e-03,3.610680477481574e-03,3.580247003127014e-03,3.549678997380513e-03,3.518977608865720e-03,3.488143991218276e-03,3.457179303042465e-03,3.426084707867677e-03,3.394861374104692e-03,3.363510475001770e-03,3.332033188600568e-03,3.300430697691875e-03,3.268704189771164e-03,3.236854856993974e-03,3.204883896131112e-03,3.172792508523681e-03,3.140581900037946e-03,3.108253281020012e-03,3.075807866250352e-03,3.043246874898158e-03,3.010571530475527e-03,2.977783060791490e-03,2.944882697905876e-03,2.911871678083012e-03,2.878751241745274e-03,2.845522633426472e-03,2.812187101725092e-03,2.778745899257373e-03,2.745200282610239e-03,2.711551512294088e-03,2.677800852695418e-03,2.643949572029324e-03,2.609998942291839e-03,2.575950239212141e-03,2.541804742204615e-03,2.507563734320775e-03,2.473228502201058e-03,2.438800336026474e-03,2.404280529470125e-03,2.369670379648598e-03,2.334971187073224e-03,2.300184255601207e-03,2.265310892386635e-03,2.230352407831360e-03,2.195310115535763e-03,2.160185332249388e-03,2.124979377821473e-03,2.089693575151347e-03,2.054329250138731e-03,2.018887731633911e-03,1.983370351387810e-03,1.947778444001943e-03,1.912113346878277e-03,1.876376400168972e-03,1.840568946726031e-03,1.804692332050843e-03,1.768747904243624e-03,1.732737013952771e-03,1.696661014324109e-03,1.660521260950056e-03,1.624319111818690e-03,1.588055927262727e-03,1.551733069908418e-03,1.515351904624360e-03,1.478913798470217e-03,1.442420120645377e-03,1.405872242437517e-03,1.369271537171103e-03,1.332619380155819e-03,1.295917148634926e-03,1.259166221733556e-03,1.222367980406954e-03,1.185523807388661e-03,1.148635087138650e-03,1.111703205791433e-03,1.074729551104125e-03,1.037715512404508e-03,1.000662480539091e-03,9.635718478212057e-04,9.264450079791583e-04,8.892833561045005e-04,8.520882886004809e-04,8.148612031307820e-04,7.776034985686973e-04,7.403165749469819e-04,7.030018334087412e-04,6.656606761599344e-04,6.282945064244359e-04,5.909047284032230e-04,5.534927472403895e-04,5.160599690007675e-04,4.786078006679509e-04,4.411376501795406e-04,4.036509265333199e-04,3.661490400356269e-04,3.286334028523334e-04,2.911054302514885e-04,2.535665435705865e-04,2.160181779769909e-04,1.784618055459533e-04,1.408990173881985e-04,1.033319034969132e-04,6.576573165924020e-05,2.825263737393469e-05}; 
	
	/*  n = 10 */ 
	static double z1024[512] = {1.533231356062638e-03,4.599679650913261e-03,7.666084694075486e-03,1.073241765154228e-02,1.379864968998444e-02,1.686475197702173e-02,1.993069568149398e-02,2.299645197373221e-02,2.606199202582973e-02,2.912728701191317e-02,3.219230810841359e-02,3.525702649433746e-02,3.832141335153771e-02,4.138543986498472e-02,4.444907722303722e-02,4.751229661771325e-02,5.057506924496107e-02,5.363736630492994e-02,5.669915900224101e-02,5.976041854625803e-02,6.282111615135810e-02,6.588122303720233e-02,6.894071042900650e-02,7.199954955781160e-02,7.505771166075438e-02,7.811516798133776e-02,8.117188976970130e-02,8.422784828289152e-02,8.728301478513213e-02,9.033736054809431e-02,9.339085685116680e-02,9.644347498172594e-02,9.949518623540578e-02,1.025459619163678e-01,1.055957733375710e-01,1.086445918210413e-01,1.116923886981417e-01,1.147391353098412e-01,1.177848030069850e-01,1.208293631505633e-01,1.238727871119810e-01,1.269150462733266e-01,1.299561120276415e-01,1.329959557791890e-01,1.360345489437232e-01,1.390718629487574e-01,1.421078692338334e-01,1.451425392507897e-01,1.481758444640298e-01,1.512077563507909e-01,1.542382464014118e-01,1.572672861196013e-01,1.602948470227058e-01,1.633209006419773e-01,1.663454185228410e-01,1.693683722251632e-01,1.723897333235182e-01,1.754094734074561e-01,1.784275640817696e-01,1.814439769667611e-01,1.844586836985096e-01,1.874716559291374e-01,1.904828653270768e-01,1.934922835773361e-01,1.964998823817662e-01,1.995056334593266e-01,2.025095085463516e-01,2.055114793968154e-01,2.085115177825984e-01,2.115095954937522e-01,2.145056843387650e-01,2.174997561448267e-01,2.204917827580940e-01,2.234817360439547e-01,2.264695878872927e-01,2.294553101927519e-01,2.324388748850010e-01,2.354202539089970e-01,2.383994192302492e-01,2.413763428350826e-01,2.443509967309017e-01,2.473233529464536e-01,2.502933835320906e-01,2.532610605600337e-01,2.562263561246347e-01,2.591892423426388e-01,2.621496913534467e-01,2.651076753193767e-01,2.680631664259264e-01,2.710161368820341e-01,2.739665589203406e-01,2.769144047974497e-01,2.798596467941893e-01,2.828022572158723e-01,2.857422083925568e-01,2.886794726793061e-01,2.916140224564491e-01,2.945458301298395e-01,2.974748681311158e-01,3.004011089179602e-01,3.033245249743575e-01,3.062450888108542e-01,3.091627729648165e-01,3.120775500006892e-01,3.149893925102530e-01,3.178982731128827e-01,3.208041644558044e-01,3.237070392143528e-01,3.266068700922282e-01,3.295036298217529e-01,3.323972911641281e-01,3.352878269096896e-01,3.381752098781638e-01,3.410594129189233e-01,3.439404089112421e-01,3.468181707645508e-01,3.496926714186912e-01,3.525638838441709e-01,3.554317810424171e-01,3.582963360460311e-01,3.611575219190411e-01,3.640153117571563e-01,3.668696786880191e-01,3.697205958714585e-01,3.725680364997420e-01,3.754119737978276e-01,3.782523810236164e-01,3.810892314682028e-01,3.839224984561267e-01,3.867521553456238e-01,3.895781755288765e-01,3.924005324322634e-01,3.952191995166100e-01,3.980341502774379e-01,4.008453582452138e-01,4.036527969855987e-01,4.064564400996967e-01,4.092562612243023e-01,4.120522340321493e-01,4.148443322321581e-01,4.176325295696824e-01,4.204167998267569e-01,4.231971168223430e-01,4.259734544125758e-01,4.287457864910092e-01,4.315140869888618e-01,4.342783298752620e-01,4.370384891574928e-01,4.397945388812359e-01,4.425464531308161e-01,4.452942060294449e-01,4.480377717394637e-01,4.507771244625871e-01,4.535122384401449e-01,4.562430879533250e-01,4.589696473234145e-01,4.616918909120419e-01,4.644097931214176e-01,4.671233283945751e-01,4.698324712156108e-01,4.725371961099244e-01,4.752374776444580e-01,4.779332904279356e-01,4.806246091111018e-01,4.833114083869601e-01,4.859936629910107e-01,4.886713477014885e-01,4.913444373395997e-01,4.940129067697591e-01,4.966767308998263e-01,4.993358846813412e-01,5.019903431097602e-01,5.046400812246908e-01,5.072850741101270e-01,5.099252968946826e-01,5.125607247518258e-01,5.151913329001124e-01,5.178170966034189e-01,5.204379911711752e-01,5.230539919585964e-01,5.256650743669147e-01,5.282712138436112e-01,5.308723858826460e-01,5.334685660246892e-01,5.360597298573503e-01,5.386458530154088e-01,5.412269111810420e-01,5.438028800840546e-01,5.463737355021069e-01,5.489394532609416e-01,5.515000092346126e-01,5.540553793457105e-01,5.566055395655898e-01,5.591504659145947e-01,5.616901344622843e-01,5.642245213276582e-01,5.667536026793804e-01,5.692773547360035e-01,5.717957537661930e-01,5.743087760889496e-01,5.768163980738323e-01,5.793185961411806e-01,5.818153467623364e-01,5.843066264598643e-01,5.867924118077738e-01,5.892726794317383e-01,5.917474060093160e-01,5.942165682701681e-01,5.966801429962784e-01,5.991381070221715e-01,6.015904372351302e-01,6.040371105754135e-01,6.064781040364728e-01,6.089133946651687e-01,6.113429595619866e-01,6.137667758812519e-01,6.161848208313454e-01,6.185970716749167e-01,6.210035057290989e-01,6.234041003657216e-01,6.257988330115231e-01,6.281876811483634e-01,6.305706223134360e-01,6.329476340994783e-01,6.353186941549832e-01,6.376837801844086e-01,6.400428699483877e-01,6.423959412639373e-01,6.447429720046670e-01,6.470839401009875e-01,6.494188235403172e-01,6.517476003672900e-01,6.540702486839614e-01,6.563867466500144e-01,6.586970724829653e-01,6.610012044583676e-01,6.632991209100174e-01,6.655908002301564e-01,6.678762208696750e-01,6.701553613383155e-01,6.724282002048740e-01,6.746947160974015e-01,6.769548877034052e-01,6.792086937700489e-01,6.814561131043529e-01,6.836971245733933e-01,6.859317071045004e-01,6.881598396854568e-01,6.903815013646960e-01,6.925966712514979e-01,6.948053285161866e-01,6.970074523903251e-01,6.992030221669115e-01,7.013920172005735e-01,7.035744169077619e-01,7.057502007669451e-01,7.079193483188013e-01,7.100818391664115e-01,7.122376529754508e-01,7.143867694743797e-01,7.165291684546352e-01,7.186648297708200e-01,7.207937333408926e-01,7.229158591463559e-01,7.250311872324454e-01,7.271396977083170e-01,7.292413707472337e-01,7.313361865867526e-01,7.334241255289101e-01,7.355051679404074e-01,7.375792942527953e-01,7.396464849626581e-01,7.417067206317964e-01,7.437599818874112e-01,7.458062494222848e-01,7.478455039949627e-01,7.498777264299350e-01,7.519028976178163e-01,7.539209985155253e-01,7.559320101464641e-01,7.579359136006965e-01,7.599326900351260e-01,7.619223206736728e-01,7.639047868074506e-01,7.658800697949419e-01,7.678481510621742e-01,7.698090121028939e-01,7.717626344787407e-01,7.737089998194209e-01,7.756480898228799e-01,7.775798862554750e-01,7.795043709521460e-01,7.814215258165864e-01,7.833313328214137e-01,7.852337740083386e-01,7.871288314883342e-01,7.890164874418039e-01,7.908967241187492e-01,7.927695238389364e-01,7.946348689920631e-01,7.964927420379235e-01,7.983431255065738e-01,8.001860019984957e-01,8.020213541847606e-01,8.038491648071928e-01,8.056694166785310e-01,8.074820926825905e-01,8.092871757744238e-01,8.110846489804812e-01,8.128744953987702e-01,8.146566981990144e-01,8.164312406228120e-01,8.181981059837932e-01,8.199572776677768e-01,8.217087391329272e-01,8.234524739099092e-01,8.251884656020433e-01,8.269166978854597e-01,8.286371545092520e-01,8.303498192956295e-01,8.320546761400698e-01,8.337517090114703e-01,8.354409019522987e-01,8.371222390787428e-01,8.387957045808606e-01,8.404612827227282e-01,8.421189578425884e-01,8.437687143529972e-01,8.454105367409712e-01,8.470444095681330e-01,8.486703174708565e-01,8.502882451604115e-01,8.518981774231068e-01,8.535000991204343e-01,8.550939951892107e-01,8.566798506417190e-01,8.582576505658500e-01,8.598273801252420e-01,8.613890245594206e-01,8.629425691839373e-01,8.644879993905080e-01,8.660253006471499e-01,8.675544584983180e-01,8.690754585650419e-01,8.705882865450599e-01,8.720929282129546e-01,8.735893694202854e-01,8.750775960957229e-01,8.765575942451802e-01,8.780293499519449e-01,8.794928493768098e-01,8.809480787582035e-01,8.823950244123190e-01,8.838336727332431e-01,8.852640101930838e-01,8.866860233420980e-01,8.880996988088177e-01,8.895050233001756e-01,8.909019836016303e-01,8.922905665772906e-01,8.936707591700388e-01,8.950425484016540e-01,8.964059213729331e-01,8.977608652638133e-01,8.991073673334917e-01,9.004454149205460e-01,9.017749954430525e-01,9.030960963987054e-01,9.044087053649336e-01,9.057128099990178e-01,9.070083980382072e-01,9.082954572998335e-01,9.095739756814265e-01,9.108439411608276e-01,9.121053417963026e-01,9.133581657266545e-01,9.146024011713345e-01,9.158380364305532e-01,9.170650598853900e-01,9.182834599979034e-01,9.194932253112384e-01,9.206943444497352e-01,9.218868061190350e-01,9.230705991061873e-01,9.242457122797550e-01,9.254121345899188e-01,9.265698550685812e-01,9.277188628294700e-01,9.288591470682402e-01,9.299906970625760e-01,9.311135021722909e-01,9.322275518394288e-01,9.333328355883627e-01,9.344293430258929e-01,9.355170638413453e-01,9.365959878066681e-01,9.376661047765279e-01,9.387274046884055e-01,9.397798775626901e-01,9.408235135027729e-01,9.418583026951410e-01,9.428842354094690e-01,9.439013019987107e-01,9.449094928991898e-01,9.459087986306899e-01,9.468992097965435e-01,9.478807170837206e-01,9.488533112629158e-01,9.498169831886358e-01,9.507717237992849e-01,9.517175241172499e-01,9.526543752489854e-01,9.535822683850969e-01,9.545011948004233e-01,9.554111458541198e-01,9.563121129897385e-01,9.572040877353089e-01,9.580870617034180e-01,9.589610265912885e-01,9.598259741808576e-01,9.606818963388538e-01,9.615287850168734e-01,9.623666322514564e-01,9.631954301641612e-01,9.640151709616388e-01,9.648258469357061e-01,9.656274504634180e-01,9.664199740071397e-01,9.672034101146173e-01,9.679777514190476e-01,9.687429906391477e-01,9.694991205792236e-01,9.702461341292372e-01,9.709840242648741e-01,9.717127840476089e-01,9.724324066247705e-01,9.731428852296072e-01,9.738442131813496e-01,9.745363838852737e-01,9.752193908327629e-01,9.758932276013692e-01,9.765578878548735e-01,9.772133653433457e-01,9.778596539032024e-01,9.784967474572661e-01,9.791246400148212e-01,9.797433256716714e-01,9.803527986101944e-01,9.809530530993970e-01,9.815440834949686e-01,9.821258842393351e-01,9.826984498617104e-01,9.832617749781478e-01,9.838158542915914e-01,9.843606825919249e-01,9.848962547560215e-01,9.854225657477916e-01,9.859396106182301e-01,9.864473845054632e-01,9.869458826347941e-01,9.874351003187474e-01,9.879150329571141e-01,9.883856760369940e-01,9.888470251328386e-01,9.892990759064927e-01,9.897418241072349e-01,9.901752655718179e-01,9.905993962245077e-01,9.910142120771213e-01,9.914197092290653e-01,9.918158838673715e-01,9.922027322667337e-01,9.925802507895418e-01,9.929484358859171e-01,9.933072840937446e-01,9.936567920387066e-01,9.939969564343137e-01,9.943277740819362e-01,9.946492418708341e-01,9.949613567781865e-01,9.952641158691200e-01,9.955575162967363e-01,9.958415553021396e-01,9.961162302144619e-01,9.963815384508895e-01,9.966374775166863e-01,9.968840450052184e-01,9.971212385979773e-01,9.973490560646014e-01,9.975674952628989e-01,9.977765541388681e-01,9.979762307267186e-01,9.981665231488915e-01,9.983474296160800e-01,9.985189484272492e-01,9.986810779696582e-01,9.988338167188826e-01,9.989771632388403e-01,9.991111161818228e-01,9.992356742885348e-01,9.993508363881507e-01,9.994566013984001e-01,9.995529683257071e-01,9.996399362654382e-01,9.997175044023747e-01,9.997856720116890e-01,9.998444384611712e-01,9.998938032169420e-01,9.999337658606178e-01,9.999643261538894e-01,9.999854843850284e-01,9.999972450545584e-01}; 
	static double w1024[512] = {3.066460309243908e-03,3.066431474717194e-03,3.066373805934901e-03,3.066287303439301e-03,3.066171968043793e-03,3.066027800832900e-03,3.065854803162254e-03,3.065652976658585e-03,3.065422323219707e-03,3.065162845014501e-03,3.064874544482890e-03,3.064557424335821e-03,3.064211487555236e-03,3.063836737394048e-03,3.063433177376105e-03,3.063000811296161e-03,3.062539643219838e-03,3.062049677483591e-03,3.061530918694663e-03,3.060983371731045e-03,3.060407041741429e-03,3.059801934145157e-03,3.059168054632175e-03,3.058505409162976e-03,3.057814003968546e-03,3.057093845550303e-03,3.056344940680037e-03,3.055567296399847e-03,3.054760920022076e-03,3.053925819129237e-03,3.053062001573948e-03,3.052169475478856e-03,3.051248249236557e-03,3.050298331509521e-03,3.049319731230012e-03,3.048312457600000e-03,3.047276520091075e-03,3.046211928444362e-03,3.045118692670423e-03,3.043996823049169e-03,3.042846330129759e-03,3.041667224730504e-03,3.040459517938762e-03,3.039223221110837e-03,3.037958345871871e-03,3.036664904115732e-03,3.035342908004907e-03,3.033992369970384e-03,3.032613302711537e-03,3.031205719196004e-03,3.029769632659570e-03,3.028305056606038e-03,3.026812004807102e-03,3.025290491302222e-03,3.023740530398486e-03,3.022162136670481e-03,3.020555324960152e-03,3.018920110376663e-03,3.017256508296258e-03,3.015564534362113e-03,3.013844204484191e-03,3.012095534839089e-03,3.010318541869891e-03,3.008513242286009e-03,3.006679653063030e-03,3.004817791442552e-03,3.002927674932023e-03,3.001009321304580e-03,2.999062748598878e-03,2.997087975118920e-03,2.995085019433890e-03,2.993053900377969e-03,2.990994637050170e-03,2.988907248814149e-03,2.986791755298025e-03,2.984648176394199e-03,2.982476532259162e-03,2.980276843313310e-03,2.978049130240749e-03,2.975793413989100e-03,2.973509715769306e-03,2.971198057055428e-03,2.968858459584444e-03,2.966490945356050e-03,2.964095536632444e-03,2.961672255938123e-03,2.959221126059671e-03,2.956742170045542e-03,2.954235411205844e-03,2.951700873112122e-03,2.949138579597133e-03,2.946548554754626e-03,2.943930822939111e-03,2.941285408765632e-03,2.938612337109538e-03,2.935911633106244e-03,2.933183322151000e-03,2.930427429898646e-03,2.927643982263378e-03,2.924833005418499e-03,2.921994525796175e-03,2.919128570087184e-03,2.916235165240670e-03,2.913314338463886e-03,2.910366117221936e-03,2.907390529237524e-03,2.904387602490684e-03,2.901357365218526e-03,2.898299845914964e-03,2.895215073330451e-03,2.892103076471707e-03,2.888963884601447e-03,2.885797527238108e-03,2.882604034155569e-03,2.879383435382870e-03,2.876135761203930e-03,2.872861042157269e-03,2.869559309035708e-03,2.866230592886091e-03,2.862874925008989e-03,2.859492336958403e-03,2.856082860541471e-03,2.852646527818167e-03,2.849183371101001e-03,2.845693422954714e-03,2.842176716195970e-03,2.838633283893053e-03,2.835063159365551e-03,2.831466376184042e-03,2.827842968169784e-03,2.824192969394393e-03,2.820516414179520e-03,2.816813337096534e-03,2.813083772966195e-03,2.809327756858324e-03,2.805545324091476e-03,2.801736510232607e-03,2.797901351096740e-03,2.794039882746627e-03,2.790152141492410e-03,2.786238163891282e-03,2.782297986747142e-03,2.778331647110245e-03,2.774339182276861e-03,2.770320629788917e-03,2.766276027433650e-03,2.762205413243248e-03,2.758108825494492e-03,2.753986302708400e-03,2.749837883649861e-03,2.745663607327271e-03,2.741463512992167e-03,2.737237640138860e-03,2.732986028504060e-03,2.728708718066502e-03,2.724405749046575e-03,2.720077161905938e-03,2.715722997347144e-03,2.711343296313256e-03,2.706938099987459e-03,2.702507449792676e-03,2.698051387391181e-03,2.693569954684199e-03,2.689063193811520e-03,2.684531147151098e-03,2.679973857318657e-03,2.675391367167283e-03,2.670783719787031e-03,2.666150958504510e-03,2.661493126882482e-03,2.656810268719449e-03,2.652102428049244e-03,2.647369649140614e-03,2.642611976496806e-03,2.637829454855148e-03,2.633022129186627e-03,2.628190044695468e-03,2.623333246818706e-03,2.618451781225764e-03,2.613545693818019e-03,2.608615030728370e-03,2.603659838320809e-03,2.598680163189980e-03,2.593676052160743e-03,2.588647552287734e-03,2.583594710854921e-03,2.578517575375163e-03,2.573416193589759e-03,2.568290613467999e-03,2.563140883206718e-03,2.557967051229837e-03,2.552769166187913e-03,2.547547276957675e-03,2.542301432641570e-03,2.537031682567299e-03,2.531738076287356e-03,2.526420663578556e-03,2.521079494441570e-03,2.515714619100460e-03,2.510326088002199e-03,2.504913951816198e-03,2.499478261433835e-03,2.494019067967971e-03,2.488536422752470e-03,2.483030377341720e-03,2.477500983510142e-03,2.471948293251711e-03,2.466372358779460e-03,2.460773232524992e-03,2.455150967137988e-03,2.449505615485711e-03,2.443837230652507e-03,2.438145865939308e-03,2.432431574863132e-03,2.426694411156577e-03,2.420934428767316e-03,2.415151681857591e-03,2.409346224803704e-03,2.403518112195504e-03,2.397667398835876e-03,2.391794139740222e-03,2.385898390135948e-03,2.379980205461942e-03,2.374039641368053e-03,2.368076753714568e-03,2.362091598571688e-03,2.356084232218999e-03,2.350054711144942e-03,2.344003092046285e-03,2.337929431827587e-03,2.331833787600665e-03,2.325716216684054e-03,2.319576776602471e-03,2.313415525086275e-03,2.307232520070920e-03,2.301027819696411e-03,2.294801482306762e-03,2.288553566449443e-03,2.282284130874829e-03,2.275993234535651e-03,2.269680936586439e-03,2.263347296382966e-03,2.256992373481692e-03,2.250616227639201e-03,2.244218918811640e-03,2.237800507154158e-03,2.231361053020336e-03,2.224900616961621e-03,2.218419259726760e-03,2.211917042261223e-03,2.205394025706634e-03,2.198850271400195e-03,2.192285840874110e-03,2.185700795855004e-03,2.179095198263344e-03,2.172469110212858e-03,2.165822594009950e-03,2.159155712153112e-03,2.152468527332341e-03,2.145761102428544e-03,2.139033500512952e-03,2.132285784846521e-03,2.125518018879345e-03,2.118730266250052e-03,2.111922590785207e-03,2.105095056498718e-03,2.098247727591226e-03,2.091380668449504e-03,2.084493943645856e-03,2.077587617937502e-03,2.070661756265976e-03,2.063716423756511e-03,2.056751685717428e-03,2.049767607639524e-03,2.042764255195451e-03,2.035741694239105e-03,2.028699990805000e-03,2.021639211107653e-03,2.014559421540958e-03,2.007460688677563e-03,2.000343079268242e-03,1.993206660241272e-03,1.986051498701796e-03,1.978877661931200e-03,1.971685217386476e-03,1.964474232699588e-03,1.957244775676837e-03,1.949996914298224e-03,1.942730716716808e-03,1.935446251258066e-03,1.928143586419256e-03,1.920822790868763e-03,1.913483933445463e-03,1.906127083158067e-03,1.898752309184481e-03,1.891359680871147e-03,1.883949267732398e-03,1.876521139449799e-03,1.869075365871494e-03,1.861612017011551e-03,1.854131163049300e-03,1.846632874328677e-03,1.839117221357557e-03,1.831584274807098e-03,1.824034105511070e-03,1.816466784465195e-03,1.808882382826473e-03,1.801280971912519e-03,1.793662623200887e-03,1.786027408328403e-03,1.778375399090486e-03,1.770706667440478e-03,1.763021285488964e-03,1.755319325503096e-03,1.747600859905911e-03,1.739865961275652e-03,1.732114702345087e-03,1.724347156000820e-03,1.716563395282611e-03,1.708763493382686e-03,1.700947523645049e-03,1.693115559564795e-03,1.685267674787415e-03,1.677403943108107e-03,1.669524438471079e-03,1.661629234968857e-03,1.653718406841584e-03,1.645792028476327e-03,1.637850174406374e-03,1.629892919310532e-03,1.621920338012431e-03,1.613932505479813e-03,1.605929496823832e-03,1.597911387298344e-03,1.589878252299205e-03,1.581830167363554e-03,1.573767208169111e-03,1.565689450533460e-03,1.557596970413338e-03,1.549489843903919e-03,1.541368147238102e-03,1.533231956785791e-03,1.525081349053178e-03,1.516916400682022e-03,1.508737188448934e-03,1.500543789264645e-03,1.492336280173295e-03,1.484114738351697e-03,1.475879241108619e-03,1.467629865884055e-03,1.459366690248495e-03,1.451089791902197e-03,1.442799248674458e-03,1.434495138522878e-03,1.426177539532632e-03,1.417846529915731e-03,1.409502188010291e-03,1.401144592279791e-03,1.392773821312342e-03,1.384389953819942e-03,1.375993068637738e-03,1.367583244723286e-03,1.359160561155807e-03,1.350725097135444e-03,1.342276931982516e-03,1.333816145136776e-03,1.325342816156659e-03,1.316857024718535e-03,1.308358850615964e-03,1.299848373758941e-03,1.291325674173146e-03,1.282790831999193e-03,1.274243927491873e-03,1.265685041019403e-03,1.257114253062669e-03,1.248531644214468e-03,1.239937295178752e-03,1.231331286769868e-03,1.222713699911798e-03,1.214084615637398e-03,1.205444115087639e-03,1.196792279510838e-03,1.188129190261900e-03,1.179454928801550e-03,1.170769576695566e-03,1.162073215614016e-03,1.153365927330485e-03,1.144647793721311e-03,1.135918896764811e-03,1.127179318540512e-03,1.118429141228380e-03,1.109668447108047e-03,1.100897318558033e-03,1.092115838054979e-03,1.083324088172866e-03,1.074522151582240e-03,1.065710111049434e-03,1.056888049435791e-03,1.048056049696885e-03,1.039214194881738e-03,1.030362568132042e-03,1.021501252681379e-03,1.012630331854433e-03,1.003749889066209e-03,9.948600078212503e-04,9.859607717128520e-04,9.770522644222740e-04,9.681345697179550e-04,9.592077714547255e-04,9.502719535730179e-04,9.413272000980781e-04,9.323735951391754e-04,9.234112228888109e-04,9.144401676219266e-04,9.054605136951128e-04,8.964723455458144e-04,8.874757476915377e-04,8.784708047290547e-04,8.694576013336086e-04,8.604362222581168e-04,8.514067523323745e-04,8.423692764622570e-04,8.333238796289207e-04,8.242706468880049e-04,8.152096633688312e-04,8.061410142736039e-04,7.970647848766078e-04,7.879810605234072e-04,7.788899266300433e-04,7.697914686822301e-04,7.606857722345520e-04,7.515729229096584e-04,7.424530063974587e-04,7.333261084543169e-04,7.241923149022446e-04,7.150517116280950e-04,7.059043845827542e-04,6.967504197803340e-04,6.875899032973623e-04,6.784229212719745e-04,6.692495599031031e-04,6.600699054496667e-04,6.508840442297606e-04,6.416920626198431e-04,6.324940470539251e-04,6.232900840227563e-04,6.140802600730122e-04,6.048646618064809e-04,5.956433758792484e-04,5.864164890008837e-04,5.771840879336241e-04,5.679462594915593e-04,5.587030905398147e-04,5.494546679937357e-04,5.402010788180699e-04,5.309424100261499e-04,5.216787486790753e-04,5.124101818848943e-04,5.031367967977850e-04,4.938586806172366e-04,4.845759205872292e-04,4.752886039954145e-04,4.659968181722958e-04,4.567006504904071e-04,4.474001883634926e-04,4.380955192456860e-04,4.287867306306889e-04,4.194739100509499e-04,4.101571450768430e-04,4.008365233158463e-04,3.915121324117206e-04,3.821840600436883e-04,3.728523939256121e-04,3.635172218051750e-04,3.541786314630598e-04,3.448367107121306e-04,3.354915473966144e-04,3.261432293912849e-04,3.167918446006486e-04,3.074374809581323e-04,2.980802264252762e-04,2.887201689909302e-04,2.793573966704570e-04,2.699919975049447e-04,2.606240595604292e-04,2.512536709271339e-04,2.418809197187298e-04,2.325058940716254e-04,2.231286821442978e-04,2.137493721166826e-04,2.043680521896466e-04,1.949848105845828e-04,1.855997355431850e-04,1.762129153274925e-04,1.668244382203495e-04,1.574343925265139e-04,1.480428665748080e-04,1.386499487219862e-04,1.292557273595155e-04,1.198602909254696e-04,1.104637279257438e-04,1.010661269730276e-04,9.166757686136692e-05,8.226816671645727e-05,7.286798631902746e-05,6.346712685980442e-05,5.406568289394001e-05,4.466375812857534e-05,3.526148598719870e-05,2.585912467646186e-05,1.645772757989687e-05,7.070076410182590e-06}; 	
	
	
	/* The points and weights structure */
	typedef struct PWstr{
		int n; double* z; double* w;
	} PW;
	
	#define SETS 27
	static PW pws[10] = {
		{2,z2,w2},
		{4,z4,w4},
		{8,z8,w8},
		{16,z16,w16},
		{32,z32,w32},
		{64,z64,w64},
		{128,z128,w128},
		{256,z256,w256},
		{512,z512,w512},
		{1024,z1024,w1024}
	};
	
	/* 
	Gauss-Legendre n-points quadrature, exact for polynomial of degree <=2n-1
	(n - even):
	
	int(f(t),t=a..b) = A*sum(w[k]*[f(B+A*z[k])+f(B-A*z[k])],k=0..n/2-1)
	A = (b-a)/2, 
	B = (a+b)/2
	
	*/
	
#ifdef __cplusplus
extern "C" {
#endif	
	
double gauss_legendre_generator(int n, double a, double b, OrbitUtils::Function* fn)
	{
		fn->clean();
		//if a and b have wrong order - fix it!
		if(b < a){
			double tmp = a;
			a = b;
			b = tmp;
		}
		
		double* z = NULL;
		double* w = NULL;
		int arr_ind = -1;
		double A,B;
		A = (b-a)/2;
		B = (a+b)/2;
		
		int n_pw = 0;
		if(n <= 1024 ){
			
			int n_2 = 4;
			int count = 0;
			for(int ii = 1; ii < 10; ii++){
				if(n > n_2){
					arr_ind = count;
					n_pw = n_2;
				} else {
					arr_ind = count + 1;
					n_pw = n_2*2;
					break;
				}
				arr_ind = count + 1;
				n_pw = n_2*2;			
			}
			
			z = pws[arr_ind].z;
			w = pws[arr_ind].w;
			
			//fill out Function object
			//???
			
		} else {
			z = pws[9].z;
			w = pws[9].w;	
			n_pw = 1024;
			int n_interv = (int)(n/1024) + 1;
			double step = (b-a)/n_interv;
			for(int i_step = 0; i_step < n_interv; i_step++){
				A = step/2;
				B= a + i_step*step + 0.5*step;
				//fill out Function object
				//???
			}
			
		}
	}
	
#ifdef __cplusplus
}
#endif	
	
}

	
	
	
